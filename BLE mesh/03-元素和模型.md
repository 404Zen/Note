
# 元素
元素定义一个节点功能的实例，每个节点都可以包括一个或者多个元素，且至少存在一个 **首要元素**。
eg. 一个可调光灯泡通常会有一个元素，这个元素就会向外公开其所具备的功能，如**通用开关**和**亮度控制**功能。在这个例子中，**Light Lightness Server Model** 就是用于实现**通用开关**和**亮度控制**功能。
假设这个调光灯泡还有一个**传感器**，那么这个节点将会拥有第二个元素。
![[Pasted image 20230217162643.png]]
节点中的每个元素都有一个唯一的地址，称为单播地址，这将允许每个元素独立于同一节点内的其他元素进行寻址，也就是说可以通过单播地址找到节点中的各个元素。

# 模型
模型定义了节点真正的功能，其汇集了一个元素的状态、转换、绑定、信息的概念。mesh模型分为三种类型。

## 服务端模型
服务端模型可以具有一个或跨越多个元素的一个或多个状态。服务端模型顶一个模型可以发送和接收的消息，他还定义了基于这些消息的元素的行为。换句话说，服务端模型公开了可以被客户端读取或控制的元素的状态。一个服务端模型的应用实例就是：对外公开传感器状态的**传感器**或者存储当前灯光状态的**灯泡**

## 客户端模型
客户端模型定义了一组请求并更改服务端状态的消息。例如，ON/OFF开关（作为客户端运行）可以向ON/OFF服务端发送消息以更改设备的状态。
![[Pasted image 20230217163629.png]]


## 控制端模型
最终的应用程序可以使用服务端模型或客户端模型，或两者以及控制逻辑。服务端和客户端模型的任意组合都会产生控制模型。
![[Pasted image 20230217163736.png]]
除了上面的之外，模型可以扩展其他模型的功能。也就是说，模型可以是分层的。例如，**灯光亮度模型**扩展了**通用开关服务端模型**和**通用等级服务端模型**。这意味着如果你在应用程序中实现**灯光亮度模型**，你将获得所有控制灯光、通用等级以及通用开关的功能；从数学的角度来说，如果A模型是B模型的子集，那么B可以称为扩展模型，而不扩展任何其他模型的模型称为 **“根模型”**；**需要注意的是：通过增加或者删除行为来改变模型是不允许的，正确的做法应该是扩展其他现有的模型组成新的模型**。

# 状态与属性

这个状态以及属性又是从模型中引出的概念，因此了解了状态与属性也是加深理解模型的重要关键。

## 状态

元素可能处于各种情况;在SIG Mesh中，这些条件存储在被称为**状态**的值中。每个状态都是元素中包含的某种类型的值。除了值之外，状态还具有与该状态关联的行为，状态由蓝牙SIG定义。例如，称为 **“通用OnOff”** 的状态，其可能具有两个值**ON或OFF(行为)**。这对于灯泡或风扇电机等设备非常有用。术语 **“通用”** 用于表示此状态及其行为可能在不同类型的Mesh设备中都有用。

## 属性

属性还包含与元素相关的值;但是与状态不同的是属性提供了解释状态的上下文。例如，要发送温度状态值的设备，温度状态可以是 **“当前室内环境温度”或“当前室外环境温度”**。在这种情况下，将使用属性来提供温度状态值的上下文。属性可以是制造商属性，它们是只读或管理员属性，允许读写访问。

## 状态转移

状态转换可以是瞬时的，或者可以在称为**转换时间**的时段内执行。

## 状态绑定

状态可以被绑定在一起，使得一个状态的变化导致另一个状态的变化。一个状态可以被绑定到多个其他的状态。例如，由调光器开关控制的灯将具有一个称为Generic OnOff的状态，另一个称为Generic Level的状态来控制灯的亮度。如果灯处于ON状态但是变暗到Level变为0时，那么OnOff状态将转换为OFF，这就是状态绑定的一个实际的案例。